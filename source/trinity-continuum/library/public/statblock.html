<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="./css/aeon.css" />
    <link rel="stylesheet" href="./css/main.css" />
    <link rel="stylesheet" href="./css/statblock.css" />
    <script src="./js/statblock.js"></script>
    <title>Stat Block</title>

</head>

<body>
    <div id="show">
        <h1>
            <span id="show-name"></span>
            <span id="show-sourceBook" style="font-size:14px"></span></h1>
        <div>
            <p id="show-description"></p>
        </div>

        <!-- Common stats -->
        <div id="primaryPool">
            <span style="font-weight: bold;">Primary Pool: </span>
            <span id="show-primary-value"></span> (<span id="show-primary-focus"></span>)
        </div>
        <div id="secondaryPool">
            <span style="font-weight: bold;">Secondary Pool: </span>
            <span id="show-secondary-value"></span> (<span id="show-secondary-focus"></span>)
        </div>
        <div id="desperationPool">
            <span style="font-weight: bold;">Desperation Pool: </span>
            <span id="show-desperation"></span>
        </div>
        <div id="enhancement">
            <span style="font-weight: bold;">Enhancements: </span>
            <span id="show-enhancement"></span>
        </div>
        <div id="defense">
            <span style="font-weight: bold;">Defense: </span>
            <span id="show-defense"></span>
        </div>
        <div id="health">
            <span style="font-weight: bold;">Health: </span>
            <span id="show-health"></span>
        </div>
        <div id="edges">
            <span style="font-weight: bold;">Edges: </span>
            <span id="show-edges"></span>
        </div>

        <!-- Talent stats -->
        <div id="anormaly" hidden>
            <div id="powers">
                <span style="font-weight: bold;">Anormaly Powers: </span>
                <span id="show-powers"></span>
            </div>
        </div>

        <!-- Talent stats -->
        <div id="talent" hidden>
            <div id="source">
                <span style="font-weight: bold;">Source: </span>
                <span id="show-source"></span>
            </div>
            <div id="gifts">
                <span style="font-weight: bold;">Gifts: </span>
                <span id="show-gifts"></span>
            </div>
        </div>

        <!-- Psion stats -->
        <div id="psion" hidden>
            <div id="psi">
                <span style="font-weight: bold;">Psi Trait: </span>
                <span id="show-psi"></span>
            </div>
            <div id="modes">
                <span style="font-weight: bold;">Modes: </span>
                <span id="show-modes"></span>
            </div>
        </div>
    </div>

    <hr />
    <div id="edit">
        <label>
            <span>Name:</span>
            <input id="edit-name" type="text" />
        </label>

        <label>
            <span>Type:</span>
            <select id="edit-type">
                <option>Normal</option>
                <option>Anormaly</option>
                <option>Talent</option>
                <option>Psion</option>
            </select>
        </label>

        <label>
            <span>Description:</span>
            <textarea id="edit-description" rows="6"></textarea>
        </label>

        <label>
            <span>Primary Pool:</span>
            <input id="edit-primary-value" type="number" />
            <input id="edit-primary-focus" class="focus" type="text" placeholder="Enter primary focus" />
        </label>

        <label>
            <span>Secondary Pool:</span>
            <input id="editSecondaryValue" type="number" />
            <input id="editSecondaryFocus" class="focus" type="text" placeholder="Enter secondary focus" />
        </label>

        <label>
            <span>Desperation Pool:</span>
            <input id="editCharacterType" type="number" />
        </label>

        <label>
            <span>Enhancements:</span>
            <input id="editEnhancement" type="number" />
            <input id="editEnhancementSource" class="focus" type="text" placeholder="Enter source of enhancement" />
        </label>

        <label>
            <span>Defense:</span>
            <input id="editDefense" type="number" />
        </label>

        <label>
            <span>Health:</span>
            <input id="editHealth" type="number" />
        </label>

        <label class="talent">
            <span>Source:</span>
            <input id="editSource" type="number" />
        </label>

        <label class="talent">
            <span>Gifts:</span>
            <input id="editGifts" type="text" />
        </label>

        <label class="anormaly">
            <span>Powers:</span>
            <input id="editPowers" type="number" />
        </label>

        <label class="psion">
            <span>Psi:</span>
            <input id="editPsi" type="number" />
        </label>

        <label class="psion">
            <span>Modes:</span>
            <input id="editModes" type="text" />
        </label>

    </div>
</body>
<script>
    (async () => {
        try {
            const userData = await getUserData();
            const sources = await getSources();
            const data = userData.data;
            const action = userData.action;

            isHidden(action, false);

            document.title = `${data.name} [Stat Block]`;

            setValue("show-sourceBook", sources[data.sourceBook]);
            setValue("show-name", data.name);
            setValue("show-description", data.description);
            setValue("show-primary-value", data.primary.value);
            setValue("show-primary-focus", data.primary.focus);
            setValue("show-secondary-value", data.secondary.value);
            setValue("show-secondary-focus", data.secondary.focus);
            setValue("show-desperation", data.desperation);
            setEnhancements("show-enhancement", data.enhancement);
            setValue("show-defense", data.defense);
            setValue("show-health", data.health);
            setArray("show-edges", data.edges);

            if (data.type == "anormaly") {
                isHidden("talent", true);
                isHidden("anormaly", false);
                isHidden("psion", true);
                setArray("show-powers", data.powers);
            }

            if (data.type == "talent") {
                isHidden("talent", false);
                isHidden("psion", true);
                setValue("show-source", data.source);
                setArray("show-gifts", data.gifts);
            }

            if (data.type == "psion") {
                isHidden("talent", true);
                isHidden("psion", false);
                setValue("show-psi", data.psi);
                setArray("show-modes", data.modes);
            }
        } catch (error) {
            console.log(error);
        }
    })();
</script>

</html>